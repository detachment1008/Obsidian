# 指令

1. 传送指令
```
r: 寄存器
i: 立即数
m: 内存

V, D： 立即数数值，8 字节
2 0：  合起来 1 字节
rA rB：合起来 1 字节

rrmovq rA, rB
2 0 rA rB

irmovq V, rB
3 0 F rB V

rmmovq ra, D(rB)
4 0 rA rB D

mrmovq D(rB), rA
5 0 rA rB D
```

2. 整数运算
```
fn: 表示 add, sub, and, xor (0 1 2 3)

6 fn：合起来 1 字节
rA rB：合起来 1 字节

Opq rA, rB
6 fn rA rB
```

3. 跳转指令
```
fn: 表示 jmp, jle, jl, je, jne, jge, jg (0 1 2 3 4 5 6)

7 fn：合起来 1 字节
Dest：8 字节

jXX Dest
7 fn Dest
```

4. 条件传送指令
```
fn：表示 cmovle, cmovl, cmove, cmovne, cmovge, cmovg (1 2 3 4 5 6)

2, fn： 合起来 1 字节
rA, rB：合起来 1 字节

cmovXX rA, rB
2 fn rA rB
```

5. 栈空间指令
```
A, 0： 1 字节
B, 0： 1 字节
rA, F：1 字节

pushq rA
A 0 rA F

popq rA
B 0 rA F
```

6. 函数调用指令
```
8, 0：1 字节
9, 0：1 字节
Dest：8 字节

call Dest
8 0 Dest

ret
9 0
```

7. 中止指令
```
0, 0：1 字节

halt
0, 0
```

8. 空指令
```
1, 0：1 字节

nop
1, 0
```

指令编码中：大端小端是针对字节之间的，字节内部都是从高到低读的
- 左边：代码部分，高位，表示指令类型
- 右边：功能部分，低位，表示具体指令

寄存器编码：只有 15 个寄存器，所以用 `0xF` 表示无寄存器
```
%rax 0
%rcx 1
%rdx 2
%rbx 3
%rsp 4
%rbp 5
%rsi 6
%rdi 7
%r8 8
%r9 9
%r10 10
%r11 11
%r12 12
%r13 13
%r14 14
```

# 异常

存在 4 种状态：
```
AOK：正常操作
HLT：遇到 halt 指令
ADR：非法地址
INS：非法指令
```

如果遇到异常，会调用异常处理程序以处理异常；但是在这里我们仅仅让处理器停止执行指令
# 信号处理
---

图形学中我们经常会遇到连续的函数，但是我们只能处理离散的，所以我们需要把连续的转换为离散的

最有效的方法之一，就是利用函数的采样值，将函数多个不同点处的值存起来需要时就重构其他函数值

1. 对函数进行采样，获取样本
2. 需要时，根据样本阵列重构原来的连续函数

但是有一个问题：把图像放大或缩小，特别是非整数倍时，会有明显的噪声，称之为走样

# 4.1 数字音频：一维采样

记录音频信号的采样过程：
1. 模数转换器(ADC)：每秒钟测量电压数千次，产生整数流，并进行存储
2. 移动到音乐播放器的内存
3. 数模转换器(DAC)：根据数值大小产生一个电压

难点：每秒钟测量多少次电压数呢

如：某个采样很容易再现低音，但是如果用这个采样去恢复短笛，就会产生奇怪的效果，如果采用更高的采样速度，就能很好的再现短笛的声音了

这种被称为欠采样干扰：
- 采样频率低于信号频率
- 当信号频率超过采样频率的一半时，就会产生混叠现象，从而引入干扰(奈奎斯特频率)

香农采样定理：信号的最高频率应该小于采样频率的一半

如果信号频率出现了奈奎斯特频率，我们就需要采取一些额外的措施来避免混叠干扰：
- 增加采样率
- 抗混叠滤波等

另外输出时，还会有重构干扰

## 采样干扰与走样

图形学中，也会存在同样的欠采样干扰和重构干扰现象：解决办法也是相同的
- 采样前滤波(模糊化的滤波)
- 重构中再次滤波(锐化的滤波)

采样后，我们得到的样本集，但是不知道与哪个原始信号对应，即找不出能够适当重构信号的唯一方法，这就是高频信号假扮了低频信号(高频信号转一圈又回来了)，这就是走样

走样经常表现为摩尔图案，即摩尔纹，它是由样本栅格与图像规则特征相互作用形成的结果

简单来说，欠采样干扰就是采样点太少，导致样本无法重构回原先的信号。而重构干扰是样本本来能够恢复到原先的信号，但是因为重构的过程中，引入了干扰或其他因素导致没有恢复成功

# 4.2 卷积

卷积是一种对函数的运算，即两个函数为输入，一个函数为输出

我们假定定义域无限(实际是有限的，并且要对端点特殊处理)

## 4.2.1 滑动平均

目的：为了获取一个点的平滑值

1. 计算该点附近 $r$ 邻域的函数的平均值，这个 $r$ 被称为平滑运算的半径，这是一个控制平滑程度的参数

连续的表达式：
$$h(x) = \frac{1}{2r}\int^{x+r}_{x-r}g(t)dt$$

离散的表达式：因为多乘了个自己，所以是 $2r+1$
$$c[i] = \frac{1}{2r+1}\sum_{j=i-r}^{i+r}b[j]$$

卷积的本质：滑动平均思想

## 4.2.2 离散卷积

如对离散序列 $a[i]$ 和离散序列 $b[i]$ 进行卷积，则计算公式：
$$(a*b)[i] = \sum_{j}a[j]b[i-j]$$ ^3f5df8

### 卷积滤波器

当有一个固定的范围，然后在这个范围内进行卷积时，就称为盒式滤波器

一般要保证它们的和为 1，这样不会影响信号的总体水平

### 卷积的性质

目前为止，卷积是一种不对称的运算：
1. $b$ 序列是我们要进行平滑的序列
2. $a$ 序列为其提供权值(只是找到它的索引是要用求差的方式得到的)

但其实，我们可以把它们互换，即将 $a$ 看作是信号，$b$ 看作是滤波器

可以将卷积看作是一种乘法：
1. 交换律
2. 结合律
3. 分配律

## 4.2.3 把卷积看作移位滤波器之和

即对 [[#^3f5df8|此式子]] 的另一种解释：

即把 $b[i-j]$ 看作是 $b[i]$ 向右移动 $j$ 个单位，此时再相乘，每一项就一一对应了

## 4.2.4 与连续函数的卷积

即离散卷积的推广：
$$(f*g)(x) = \int_{-\infty}^{+\infty}f(t)g(x-t)dt$$

## 4.2.5 离散-连续卷积

1. 连续函数->离散函数：采样
2. 离散函数->连续函数：重构，此时需要用到离散-连续卷积
$$(a*f)(x)=\sum_ia[i]f(x-i)$$
- $f$ ：滤波器
- $a$：离散序列

注意：取的 $i$ 点未必在 $a$ 序列中就有，因为我们希望化成连续的，所以使用 $a$ 中采样的其他点，配合上这个滤波器来计算目标 $i$ 点，从而重构为连续的函数

## 4.2.6 多维卷积

离散卷积的二维形式：
$$(a*b)[i,j]=\sum_{i'}\sum_{j'}a[i',j']b[i-i',j-j']$$

# 4.3 卷积滤波器

图形学中常用的特殊滤波器：

## 4.3.1 各种卷积滤波器

### 1.盒式滤波器

即以原点对称，高度相同的函数

用于计算一个窗口的平均值，并用这个平均值代替窗口中点的那个值

一般取高度为 1，然后窗口长度也为 1，即左右各 0.5

### 2.帐篷式滤波器

也称为线性滤波器

也是以原点对称的，但是它中点高，然后线性降下来，所以它的窗口长度要比盒式滤波器要大一倍

它的窗口中点的权重最大，然后其他的离窗口的距离越大，权重越小

### 3.高斯滤波器

也称为正态滤波器，即它的函数曲线是正态分布曲线

它滤波出来的结果非常平滑

### 4.三次B样条滤波器

它是分段多项式，经常用于重构滤波器

它在\[-1,1]是一种，\[-2,-1] 与 \[1,2] 内是一种，当在原点时，高度为 $\frac{2}{3}$，所以最终结果需要乘以 $\frac{1}6$

### 5.三次Catmull-Rom滤波器

它和三次B样条滤波器的范围相同，只是不同区间的计算公式不一样，最终结果乘以的也是 $\frac{1}2$ 而不是 $\frac{1}6$

### 6.三次Mitchell-Netravali滤波器

它是上面两种的加权组合，是折中的滤波器

## 4.3.2 滤波器性质

待后续再看

# 4.4 图像信号处理

之前我们讨论的，都是一维信号，下面讨论图像相关

## 4.4.1 离散图像滤波器

图像上，一般用滤波器对图像进行卷积，从而实现对图像的模糊化

如：高斯滤波器的结果非常平滑，所以常用它来进行模糊化处理

与图像模糊化相对的运算是图像锐化
- 模糊掩膜：
- 阴影：

## 4.4.2 图像采样中的反走样技术
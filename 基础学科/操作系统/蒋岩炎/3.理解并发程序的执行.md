# 复习

程序 = 状态机
- 全局变量
- 堆
- 栈帧链
	- 局部状态
	- PC

并发程序 = 多个栈帧的状态机
- 多个执行流
- 共享内存

每次执行选择一个栈帧链进行执行

注意：编译器和多处理器(也算是一种编译器)都会对你的无锁程序造成影响

# 一个互斥算法

互斥：两个线程不能同时执行一段代码

前提：假设一个内存的读/写可以保证顺序、原子完成

## Peterson 算法

是一种针对只有两个线程之间的协议：假设是 A 和 B
1. 当希望访问时，会首先举旗(写入共享)
2. 然后，在门上贴上另一个线程的名字(另一个共享内存写入)
3. 然后判断对方是否举旗
	1. 如果没有举旗，直接进入即可
	2. 如果对方也举旗：根据门上的线程名字进入即可

# 正确性证明和压力测试

当我们用画出完整的状态图时，如果没有竟态状态，就完成了这个算法的证明

建议使用 Python，它可以使用丰富的库函数

# 自动证明：模型检验

使用 model-checker 来画图

其实就是把状态机变成了图，然后利用图的知识去证明
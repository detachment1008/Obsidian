# 10088 Bug 分析
---

## 功能需求

![[Pasted image 20230831172126.png]]

## 服务端做法

- 进入主题：同步每个轴上的倍数
- Spin：发送 1005 协议的同时，给上方的倍数 +1

## 客户端做法

- 进入主题：同步记录每个轴上的倍数
- Spin：判断结果是否有 $boost$ ，如果有则轴停后给上方倍数 +1
- 升级：再次同步每个轴上的倍数

## 问题：倍数不统一导致差钱

- 复现：spin 结果有 $boost$ 的同时升级

客户端和服务端计算倍数的时机不同，而在中间又进行了同步导致。

## 解决办法

1. 客户端不做计算，每次 Spin 服务端都发送本次 Spin 后的结果倍数，客户端仅根据轴内是否有 $boost$ 做显示(10088 使用的解决办法)
2. 客户端在接收到 1005 时，立即计算结果(必需保证 1005 在 3001 之前)
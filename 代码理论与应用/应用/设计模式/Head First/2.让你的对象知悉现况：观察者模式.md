# 观察者模式
---

出版社 + 订阅者 = 观察者模式

### 步骤

1. 对象进行订阅
2. 主题将此对象加入观察者
3. 当事件触发时，给所有订阅者发消息
4. 当不想观察时，对象取消订阅
5. 主题将此对象从观察者移除
6. 当主题的事件再次触发，该对象将不会收到信息

### 定义

观察者模式：定义了对象之间的一对多依赖，这样一来，当一个对象改变状态时，它的所有依赖者都会收到通知并自动更新

### 松耦合

当两个对象之间松耦合，它们依然可以交互，但是不太清楚彼此的细节
- 耦合：即指依赖程度，如：强耦合的话，一个改变另一个也会受之影响
- 观察者模式：提供了一种对象设计，让主题和观察值之间松耦合

对于主题：
- 只知道观察者实现了某个接口，不知道它是谁或做了什么
- 只维护一个实现了 Observer 接口的对象列表，可以随时增加或删除对象
- 当有新类型观察者出现时，主题代码不需要修改

对于观察者：
- 它们要实现同一个接口，以供主题调用
- 在这个接口中，各个观察者可以实现自身的逻辑
- 它也会保存一个主题的对象，用于自身的注册和移除

回调函数就是观察者模式实现的方式之一，但它通常也是 1 对 1 的
- 它也相当于一个事件发生后，通知一个对象

### 设计原则 4

为了交互对象之间的松耦合设计而努力
- 目的是为了让我们的系统更有弹性，能够应对变化

### 观察者获取信息的方式

1. 推：即主题直接把信息发送给观察者
	- 一般第一个参数为主题对象，第二个参数为数据
2. 拉：即主题告诉观察者数据已更新，并提供一些接口供外部使用
	- 观察者根据需要，调用接口来进行获取需要的数据
	- 一般只用传递主题对象即可，方便观察者通过这个主题对象调用接口

当一个对象即使观察者，也是主题时，它可以设置一个变量，用以控制事件发生的敏感程度，
- 即不必自己收到数据后，立即发送
	- 即每次发送前判断变量
- 它可以等待收到一部分数据后，再设置变量为 true
	- 此时，观察到数据就可以作为主题发送给其他观察者了


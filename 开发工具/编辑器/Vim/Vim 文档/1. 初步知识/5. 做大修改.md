# 宏

# 替换

一些标志位：
```
g: 整行的全局替换
p: 替换时，打印出最后一个替换的地方
c: 在每个替换的地方，都确认一下(confirm)
	y: 替换
	n: 不替换
	a: 这个地方和剩下的全部替换
	q: 退出，这个地方和剩下的不再进行任何替换
	l: 替换完当前节点后，退出
	C-E: 向上滚动
	C-Y: 向下滚动
e: 找不到内容时不报错
```

范围选择：

前向查找：`?<pattern>?
后向查找：`/<pattern>/`
使用标记：`'m`
使用可视模式范围：`'<` 和 `'>`
位置调整：`<位置>-1`

# `global` 命令

类似于替换命令，但它不是替换，而是执行命令

```
g<分割符><pattern><分割符><命令>
```

它是从第一行开始，逐行匹配然后执行的，可以利用这个交换行序：
```
g/^/m 0
```

# `read` 命令

将某个文件中的内容全部插入到当前光标处：
```
read <filename>
```

可以通过前缀，设置插入的位置：
如，在文件的最后插入：
```
$read <filename>
```

# 保存部分行

文件不存在时

```
.,$write <filename>
```

如果文件已经存在，就必须强制执行

```
,,$write! <filename>
```

# 给其他文件追加内容

将当前行的内容追加到目标文件的后面

```
.write >> <filename>
```

# 过滤命令

格式：`<范围>!<外部命令>

效果：用外部命令输出的内容覆盖指定的范围

如：当前文件内容排序
```
%!sort
```

## 读入命令的输出内容

```
read !ls
```

## 将内容输出给命令

```
write !wc
```

## 可以利用外部命令，打开指定文件

利用 `grep` 命令，打开有 `foo` 的文件

```
vim `grep -l foo *.c`
```

## `grep` 命令

因为它太常用了，使用它的时候不用加 ! 就可以直接使用
# `vimrc` 文件

多数用户想要得到的缺省值：
```
source $VIMRUNTIME/defaults.vim
```

## 备份文件和多级撤销

当覆盖一个文件时，保留一个备份：
```
set backup
set nobackup
```

设置在一个文件中保存多层撤销信息(如：关闭文件再打开，依然能够撤销)：
```
set undofile
set noundofile
```

应用：
```
if has("vms")
    set nobackup
else
	set backup
	if has('persistent_undo')
		set undofile
	endif
endif
```

## 高亮模式查找位置

选项：
```
set hlsearch
set nohlsearch
```

应用：
```
if &t_Co > 2 || has("gui_running")
	set hlsearch
end
```
- `t_Co`：是 Vim 的内置变量，表示终端的颜色支持个数

## 设置自动换行的长度

选项：
```
set textwidth=78
```

更新自动换行：
```
gq+[motion]
```
- 只在空格处进行自动换行

应用：
```
augroup vimrcEx
	au!
	autocmd FileType text setlocal textwidth=78
augroup END
```
- `setlocal`：对当前缓冲区生效(应该和 `set b:textwidth` 效果相同)

## 载入 `matchit` 插件

应用：
```
if has('syntax') && has('eval')
	packadd! matchit
endif
```
- 增强的 `%` 插件，支持 `HTML` 标签和 `vimscript`
- 因为不后向兼容，所以没有默认打开

### `packadd` 命令

这个应该是加载软件包的命令

1. 插件查询路径
```
set packpath?
```

2. 插件寻找规则
	- `pack` 文件夹
		- `<name>` 文件夹，表明是一个软件包
			- `start` 文件夹
			- `opt` 文件夹

3. `start` 文件夹中的插件默认加载，`opt` 文件夹中的插件只有在执行 `packadd` 命令时才会被加载

# `default.vim` 文件

## 判断是否加载

```
if exists('skip_defaults_vim')
	finish
endif
```

##  `vi` 兼容

```
set nocompatible
```

## 回退键

```
set backspace=indent,eol,start
```
- 允许回退键删除缩进
- 允许回退键删除换行符
- 允许回退键在插入模式下删除到 `insert` 开始之前的位置

## 历史查找记录(命令和查找)

```
set history=200
```

## 右下角显示光标

```
set ruler
```

## 右下角显示未完成的命令

```
set showcmd
```

## 补全

```
set wildmenu
```

## `Esc` 等待时间

```
set ttimeout
set ttimeoutlen=100
```

## 截断时的显示

```
set display=truncate
```

## 输入查找时显示匹配点

```
set incsearch
```

## 不把 0 开头的数识别为 8 进制

```
set nrformats-=octal
```

## 自动换行按键映射

```
map Q gq
```

## 插入模式按键映射

```
inoremap <C-U> <C-G>u<C-U>
```
- 不懂有什么作用

## 启用鼠标

```
if has('mouse')
	set mouse=a
endif
```

## 可视模式按键映射

```
vnoremap _g y:exe "grep /" .. escape(@", '\\/') .. "/ *.c *.h"<CR>
```
- 不懂有什么用

## 打开文件的高亮

```
syntax on
```

## 启动文件类型、插件、缩进的自动探测和加载

```
filetype plugin indent on
```

## 自动命令

```
autocmd BufReadPost *` `\ if line("'\"") >= 1 && line("'\"") <= line("$") && &ft !~# 'commit'` ``\ | exe "normal! g`\""`` `\ | endif
```

## 添加查看和原先文件差异的命令

```
command DiffOrig vert new | set bt=nofile | r ++edit # | 0d_ | diffthis` `\ | wincmd p | diffthis
```

## 禁用语言映射

```
set nolangremap
```

# 插件

## 插件类型

### 全局插件

用于所有文件类型的插件

### 文件类型插件

用于某个文件类型的插件

需要：`filetype plugin on` 命令启动它

## 添加插件

### 获取一个插件的拷贝

1. 内置默认启动插件：
	- 全局插件：`$VIMRUNTIME/plugin/`
	- 文件插件：`$VIMRUNTIME/ftplugin/`
2. 非默认启动：`$VIMRUNTIME/macros/` 和 `$VIM/vimfiles/pack/dist/opt/`

### 将它塞进合适的目录

#### 全局插件

Unix：`~/.vim/plugin/`

#### 文件插件

Unix：`~/.vim/ftplugin/`

1. 命名必须以对应文件的后缀命名
2. 可以用下划线分割，即：`<文件名>_<其他信息>.vim`
3. 可以通过目录分割，即：`ftplugin/<filetype>/<随意名字>.vim`

# 选项窗口

```
:options
```

选项恢复默认值：`set number&`